# 选题文档

**项目：** TRPG桌游在线平台

**由于TRPG的特殊性，其规则由主持人制定，此项目只是辅助工具的集合，不是游戏**

## 背景介绍

TRPG是一大类自由度和开放性非常高的桌游的统称。它们的共同特点是：一次游戏需要玩家和主持人的参与，游戏规则由主持人制定；主持人使用剧本来控制游戏走向；玩家使用人物卡来参与进游戏之中，使用骰子决定游戏中的各种事件并改变人物卡状态。

TRPG的特性使得玩游戏前的准备工作变得相当冗长。对于大部分成熟的TRPG规则来说，想要创建一张人物卡需要大量复杂的计算，在不依赖电子设备的情况下甚至需要几个小时。现在普遍使用的Excel格式人物卡虽然大幅降低了其难度，也有只支持单一游戏规则、容易因错误的修改而被破坏、移动端体验极差等缺点。

同时，一局TRPG游戏可能会持续几个小时，而由于TRPG本质上是在讲述一个故事，主持人经常需要回忆玩家们之前做出的行动。此时，游戏内的历史记录功能就显得很必要。然而，对于没有电子设备的TRPG游戏，记下历史记录显然十分困难。目前流行的Excel格式人物卡也不存在任何历史记录功能。

市面上已经有了一些集成起来的TRPG游戏平台，但是它们的使用大多通过输入复杂的指令，极为抽象，不适合非计算机专业的玩家使用。同时，它们也没有支持历史记录功能。

## 项目需求

一个TRPG游戏平台，实现游戏规则自定义、人物卡创建、剧本编辑、游戏中辅助、历史记录及回放等功能。

### 游戏规则自定义

主持人可以在平台上注册一种 **游戏规则** 。游戏规则包含玩家手册、主持人手册以及 **人物卡模板** 。玩家手册与主持人手册均为纯文本，平台不做检查。人物卡模板用于人物卡的制作，在现有的平台中一般需要手动编写XML代码来实现。 **本项目将实现一个可视化编辑器，用于直观地创建人物卡模板。**

### 人物卡创建

玩家可以通过平台上现存的人物卡模板，通过可视化编辑器创建人物卡，供游戏使用。

### 剧本编辑

现存的TRPG平台中，剧本大多以纯文本方式提供。 **本项目将设计一个剧本编辑器，并设计一种类似Markdown的专门用于写剧本的语言（应该会由Markdown拓展而来）。该语言可以在剧本中嵌入一些简单的可执行脚本，通过这些脚本，在游戏过程中，主持人可以根据剧本一键对玩家的人物卡进行操作。**

### 游戏中辅助

主持人和玩家可以在平台上创建游戏房间，并开始游戏。游戏状态中，平台将向主持人显示剧本及各个玩家的人物卡，并为主持人和玩家提供掷骰子功能。掷骰子功能与人物卡绑定，可以自动根据结果更新人物卡数据。现存的TRPG平台中，掷骰子功能一般要求玩家输入指令， **但本项目将把常用的掷骰子操作用图形界面实现。同时，在游戏规则设计阶段，主持人也可以把一些需要多次掷骰子和更新人物卡状态的连续操作编写为脚本，与游戏规则一起上传。游戏过程中，玩家或主持人可以一键执行这些脚本。**

此外，平台将会向玩家和主持人显示一个 **地图** 以方便玩家和主持人的交流。地图基本上是一个可以多人编辑的画板，并且上面有代表每个玩家的棋子。玩家可以在地图上绘画，或者移动代表自己的棋子。主持人也可以在地图上绘画，并且可以更改其背景图片。

最后，平台会提供语音及文字聊天的功能。（此功能是否完成视最后的项目完成进度而定，即使平台没有聊天功能，主持人和玩家也可以在使用平台其他功能的同时，用第三方平台聊天。）

### 历史记录及回放

玩家的人物卡每个属性的变化以及变化发生的时间都会作为历史记录被记录。游戏中或者游戏结束后，玩家和主持人都可以查看这些历史记录。

此外，地图的状态会在每次背景图切换时、每隔一定时间或者在由主持人自定义的时刻记录进历史记录。

如果语音和文字聊天被实现，玩家的发言也会记录在历史记录中。


## 检验方式

首先，项目将使用Cypress端到端测试工具进行详细测试。接下来，将**Call of Cthulhu v7.0**游戏规则输入项目，并输入一个官方剧本。最后，小组成员将会使用项目实际进行一次TRPG游戏，其全过程将会被记录，以彻底检验项目的所有功能。

## 其他

由于TRPG自由度实在太高，本项目可能无法完全支持所有类型的TRPG。它将首先保证对 **Call of Cthulhu** 以及与它类似的规则（一般统称为 **D100规则** ）的最大程度支持，再去支持其他可能的TRPG规则,如 **Dragons and Dungeons** 。 理论上来说，通过上文所述的脚本，最终的项目可以实现对任何TRPG规则的支持。
